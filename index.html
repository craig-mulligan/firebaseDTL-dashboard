<!DOCTYPE html>
<html>

<head>
    <link rel="stylesheet" href="http://cdn.jsdelivr.net/chartist.js/latest/chartist.min.css">
    <script src="http://cdn.jsdelivr.net/chartist.js/latest/chartist.min.js"></script>
    <link rel="stylesheet" href="style.css">
</head>



<body>
<div class="container">
    <!-- graph -->
    <h1>Resin tempreture logger</h1>
    <div class="ct-chart"></div>
    
  
</div>
<script src="https://cdn.firebase.com/js/client/2.0.1/firebase.js"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
<script type="text/javascript">
    var ref = new Firebase("https://temp-tracker.firebaseio.com/");

    ref.once("value", function(snapshot, callback) {
      var list = [];
      var temps2013 = [];
      var temps2014 = [];
      labels = [];

      list = snapshot.val();
      var allyears = Object.keys(list);
      var yearCount = allyears.length;
     
      // get data by year
       year1 = list[2013];
       year2 = list[2014];

        // first year loop
        $.each(year1, function (index) {
          var day = year1[index]
          // set the labels for 2014
          var dayslabels = Object.keys(year1[index]);
          $.each(dayslabels, function (index) {
            labels.push(dayslabels[index]);
          });


          $.each(day, function (index) {
            var log = day[index];
            temps2014.push(log.temp);
          });
        }); 
    
        
        // 2nd year loop
        $.each(year2, function (index) {
          var day = year2[index]
          $.each(day, function (index) {
            var log = day[index];
            temps2013.push(log.temp);
          });
        });
        
    
        new Chartist.Line('.ct-chart', {
          labels: labels,
          series: [
            temps2014, temps2013
          ]
        });

        

    }, function (errorObject) {
      console.log("The read failed: " + errorObject.code);
    });
      
</script>
</body>
</html>
